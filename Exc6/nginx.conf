http {
   # Настройка upstream для балансировки нагрузки
   upstream backend_servers {
       server backend1.example.com;
       server backend2.example.com;
       server backend3.example.com;
   }
  # Лимит на 10 запросов в минуту
  limit_req_zone $address zone=request_limit:10m rate=10r/m;

   server {
       listen 80;

       location / {
           limit_req zone=request_limit burst=5 nodelay;
           error_page 429 = 429 @rate_limited;
           proxy_pass http://backend_servers;
       }
       # Обработчик ошибки 429
       location @rate_limited {
           return 429 'Request limit reached, try again in a minute';
       }
   }
}